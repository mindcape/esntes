============================= test session starts ==============================
platform darwin -- Python 3.7.9, pytest-7.4.4, pluggy-1.2.0 -- /Users/nagadheeranreddyseelam/esntes/backend/venv/bin/python3
cachedir: .pytest_cache
rootdir: /Users/nagadheeranreddyseelam/esntes/backend
configfile: pytest.ini
plugins: cov-4.1.0, anyio-3.7.1, asyncio-0.21.2
asyncio: mode=auto
collecting ... collected 1 item

backend/tests/integration/test_mass_comm_flow.py::test_mass_comm_full_flow FAILED [100%]

=================================== FAILURES ===================================
___________________________ test_mass_comm_full_flow ___________________________

db_session = <sqlalchemy.orm.session.Session object at 0x7fac56ec1050>

    def test_mass_comm_full_flow(db_session):
        # Override DB
        def get_test_db():
            try:
                yield db_session
            finally:
                pass
    
        app.dependency_overrides[get_db] = get_test_db
        app.dependency_overrides[get_current_user] = mock_get_current_user
    
        # Setup DB Data
        # 1. Roles
        role_board = Role(name="board")
        role_resident = Role(name="resident")
        db_session.add(role_board)
        db_session.add(role_resident)
        db_session.commit()
    
        # 2. Users
        # Admin (Current user mock ID=1)
        admin = User(id=1, email="admin@example.com", full_name="Admin", community_id=1, role=role_board)
        res1 = User(id=2, email="res1@test.com", full_name="Res 1", community_id=1, role=role_resident)
        res2 = User(id=3, email="res2@test.com", full_name="Res 2", community_id=1, role=role_resident)
    
        db_session.add(admin)
        db_session.add(res1)
        db_session.add(res2)
        db_session.commit()
    
        # 3. Create Template
        template_payload = {
            "name": "Integration Test Template",
            "subject_template": "Hello {{first_name}}",
            "content_html": "<p>Welcome {{first_name}}</p>"
        }
    
>       resp = client.post("/api/communication/templates", json=template_payload)
E       NameError: name 'client' is not defined

backend/tests/integration/test_mass_comm_flow.py:62: NameError
=============================== warnings summary ===============================
backend/venv/lib/python3.7/site-packages/jose/backends/cryptography_backend.py:4
  /Users/nagadheeranreddyseelam/esntes/backend/venv/lib/python3.7/site-packages/jose/backends/cryptography_backend.py:4: CryptographyDeprecationWarning: Python 3.7 is no longer supported by the Python core team and support for it is deprecated in cryptography. The next release of cryptography will remove support for Python 3.7.
    from cryptography.exceptions import InvalidSignature, InvalidTag

backend/core/database.py:22
  /Users/nagadheeranreddyseelam/esntes/backend/../backend/core/database.py:22: MovedIn20Warning: The ``declarative_base()`` function is now available as sqlalchemy.orm.declarative_base(). (deprecated since: 2.0) (Background on SQLAlchemy 2.0 at: https://sqlalche.me/e/b8d9)
    Base = declarative_base()

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ============================
FAILED backend/tests/integration/test_mass_comm_flow.py::test_mass_comm_full_flow
======================== 1 failed, 2 warnings in 0.55s =========================
